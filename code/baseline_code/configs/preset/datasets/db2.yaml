# @package _global_

dataset_base_path: "./data/datasets/"   # Change your path

datasets:
  train_dataset:
    _target_: ${dataset_path}.OCRDataset
    image_path: ${dataset_base_path}images/train
    annotation_path: ${dataset_base_path}jsons/train.json
    transform: ${transforms.train_transform}
  val_dataset:
    _target_: ${dataset_path}.OCRDataset
    image_path: ${dataset_base_path}images/val
    annotation_path: ${dataset_base_path}jsons/val.json
    transform: ${transforms.val_transform}
  test_dataset:
    _target_: ${dataset_path}.OCRDataset
    image_path: ${dataset_base_path}images/val
    annotation_path: ${dataset_base_path}jsons/val.json
    transform: ${transforms.test_transform}
  predict_dataset:
    _target_: ${dataset_path}.OCRDataset
    image_path: ${dataset_base_path}images/test
    annotation_path: null
    transform: ${transforms.test_transform}

transforms:
  train_transform:
    _target_: ${dataset_path}.DBTransforms
    transforms:
      - _target_: albumentations.LongestMaxSize
        max_size: 640
        p: 1.0
      - _target_: albumentations.PadIfNeeded
        min_width: 640
        min_height: 640
        border_mode: 0
        p: 1.0
      - _target_: albumentations.HorizontalFlip
        p: 0.5
      # - _target_: albumentations.VerticalFlip
      #   p: 0.5
      # - _target_: albumentations.ShiftScaleRotate
      #   shift_limit: 0.0625
      #   scale_limit: 0.1
      #   rotate_limit: 15
      #   p: 0.5
      # 색상/밝기 조정 증강
      - _target_: albumentations.RandomBrightnessContrast
        brightness_limit: 0.2772984123453732
        contrast_limit: 0.283989673632353
        p: 0.3384684186607359
      # - _target_: albumentations.ColorJitter
      #   brightness: 0.1482166002922425
      #   contrast: 0.1380738907923448
      #   saturation: 0.03303697914933371
      #   hue: 0.093762861716502
      #   p: 0.024452081273023007
      # - _target_: albumentations.RandomGamma
      #   gamma_limit: [82, 128]
      #   p: 0.122251369866415
      # - _target_: albumentations.HueSaturationValue
      #   hue_shift_limit: 20
      #   sat_shift_limit: 30
      #   val_shift_limit: 20
      #   p: 0.3
      # 블러/노이즈 증강
      # - _target_: albumentations.GaussianBlur
      #   blur_limit: 5
      #   p: 0.1896680736951049
      # - _target_: albumentations.MotionBlur
      #   blur_limit: [3, 7]
      #   p: 0.2
      # - _target_: albumentations.GaussNoise
      #   std_range: [0.02, 0.08]
      #   mean_range: [0.0, 0.0]
      #   p: 0.2
      # 이미지 품질 증강
      # - _target_: albumentations.ImageCompression
      #   quality_range: [75, 100]
      #   p: 0.2
      # - _target_: albumentations.Sharpen
      #   alpha: [0.2, 0.5]
      #   lightness: [0.5, 1.0]
      #   p: 0.2
      # - _target_: albumentations.Downscale
      #   scale_range: [0.75, 0.95]
      #   p: 0.2
      # 날씨/조명 효과 증강
      # - _target_: albumentations.RandomShadow
      #   shadow_roi: [0, 0.5, 1, 1]
      #   num_shadows_limit: [2, 4]
      #   shadow_dimension: 6
      #   p: 0.0558550781178635
      # - _target_: albumentations.PlasmaShadow
      #   shadow_intensity_range: [0.3, 0.7]
      #   roughness: 3.0
      #   p: 0.2
      # - _target_: albumentations.RandomFog
      #   fog_coef_range: [0.1, 0.3]
      #   alpha_coef: 0.08
      #   p: 0.2
      - _target_: albumentations.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    keypoint_params:
      _target_: albumentations.KeypointParams
      format: 'xy'
      remove_invisible: True
  val_transform:
    _target_: ${dataset_path}.DBTransforms
    transforms:
      - _target_: albumentations.LongestMaxSize
        max_size: 640
        p: 1.0
      - _target_: albumentations.PadIfNeeded
        min_width: 640
        min_height: 640
        border_mode: 0
        p: 1.0
      - _target_: albumentations.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    keypoint_params:
      _target_: albumentations.KeypointParams
      format: 'xy'
      remove_invisible: True
  test_transform:
    _target_: ${dataset_path}.DBTransforms
    transforms:
      - _target_: albumentations.LongestMaxSize
        max_size: 640
        p: 1.0
      - _target_: albumentations.PadIfNeeded
        min_width: 640
        min_height: 640
        border_mode: 0
        p: 1.0
      - _target_: albumentations.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    keypoint_params:
      _target_: albumentations.KeypointParams
      format: 'xy'
      remove_invisible: True
  predict_transform:
    _target_: ${dataset_path}.DBTransforms
    transforms:
      - _target_: albumentations.LongestMaxSize
        max_size: 640
        p: 1.0
      - _target_: albumentations.PadIfNeeded
        min_width: 640
        min_height: 640
        border_mode: 0
        p: 1.0
      - _target_: albumentations.Normalize
        mean: [0.485, 0.456, 0.406]
        std: [0.229, 0.224, 0.225]
    keypoint_params: null

dataloaders:
  train_dataloader:
    batch_size: 16
    shuffle: True
    num_workers: 4
  val_dataloader:
    batch_size: 16
    shuffle: False
    num_workers: 4
  test_dataloader:
    batch_size: 16
    shuffle: False
    num_workers: 4
  predict_dataloader:
    batch_size: 1
    shuffle: False
    num_workers: 4

collate_fn:
  _target_: ${dataset_path}.DBCollateFN
  shrink_ratio: 0.4
  thresh_min: 0.3
  thresh_max: 0.7
